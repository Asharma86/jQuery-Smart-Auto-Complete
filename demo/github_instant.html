<!DOCTYPE html>
<html>
<head>
  <title>GitHub Instant</title>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1">

  <link media="screen" type="text/css" href="stylesheets/application.css" rel="stylesheet">
  <link media="screen" type="text/css" href="stylesheets/smooth_theme.css" rel="stylesheet">

  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
  <script type="text/javascript" src="../jquery.smart_autocomplete.js"></script>

  <script type="text/javascript">
    $(function(){
        $("#search_field").smartAutoComplete({
          filter: function(term){
           return $.Deferred(function(dfd){ 
              $.getJSON("http://github.com/api/v2/json/repos/search/" + term + "?callback=?").success( function(data){
                dfd.resolve( $.map(data.repositories, function(r){ return r; }) );          
              }); 
           }).promise(); 
          },
          resultsContainer: "div#results",
          resultFormatter: function(r){ return "<h3><a href='" + r.url + "'>" + r.name + "</a> (" + r.language + ")</h3><p>" + r.description + "</p><div class='details'><span>Owner: " + r.owner + "</span> | <span>Forks: " + r.forks + "</span> | <span>Watchers: " + r.watchers + "</span></div>" },
          minCharLimit: 0, delay: 200});

        $("#search_field").bind({
          keyIn: function(){
            //clear exisiting results
            $(this).smartAutoComplete().clearResults();
            
            $("div#results").html("Loading...");
          },

          //we don't need the default behaviour of following events
          itemSelect: function(ev){ ev.preventDefault(); },
          itemOver: function(ev){ ev.preventDefault(); },
          itemOut: function(ev){ ev.preventDefault(); }

        });
    });
  </script>

  <style>
    ul li {list-style: none; cursor: pointer;}
    li.highlight {background-color: #c0c0c0;}
    ul { margin: 10px 0; padding: 5px; background-color: #aeaeae; }

  </style>

</head>

<body>
   <div id="container">
      <div id="header"><h1>GitHub Instant</h1></div>
      <div id="wrapper">
        <div id="content">
          <form>
            <input type="text" autocomplete="off" id="search_field" placeholder="Type here to start searching"/>
          </form>
          <div id="results">

          </div>
        </div>
      </div>
    </div>
</body>
</html>
